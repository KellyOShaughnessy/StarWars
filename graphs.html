<html>
<head>
	<!-- <link rel="stylesheet" href="main.css"> -->
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
</head>
<body>
	<script>
	

 d3.csv("planet_info.csv", function(RandCSV) {
 	var dataset = {planets:[]};
 	var type_counts = [0,0,0,0,0,0,0];
 	var d_counts = [0,0];
 	var diams = [];
 	var pops = [];

    RandCSV.forEach(function(planetRow, i) {
      if (planetRow["PLANET"] != null) {
        dataset.planets.push({
        	id: planetRow["PLANET"],
        	type: planetRow["TYPE"],
        	diameter: planetRow["DIAMETER (km)"],
        	pop: planetRow["POPULATION"],
        	films: planetRow["FILMS (EP)"],
        	url: planetRow["IMAGE"]
        });
      }
    });
    for (var i=0; i<dataset.planets.length; i++) {
    	var t = dataset.planets[i].type;
    	if (t == "Terrestrial") { type_counts[0] ++; }
    	if (t == "Gas") { type_counts[1] ++; }
    	if (t == "Swamp") { type_counts[2] ++; }
    	if (t == "Metal") { type_counts[3] ++;}
    	if (t == "Ice") { type_counts[4] ++;}
    	if (t == "Oceanic") { type_counts[5] ++;}
    	if (t == "Urban") { type_counts[6] ++;}
    }
    for (var i=0; i<dataset.planets.length; i++) {
    	var d = dataset.planets[i].diameter;
    	var p = dataset.planets[i].pop;

    	pops.push(p);

    	diams.push(d);
    	if (d < 12742) { d_counts[0] ++;}
    	if (d > 12742) { d_counts[1] ++;}
    }

//Breakdown of planet type
var width = 250,
    height = 250,
    radius = Math.min(width, height) / 2;

var color = ["#993300","#ffd633","#339966","#d9d9d9", "#ccffff", "#80b3ff", "#0000cc", "blue", "red","black","orange","yellow","green","purple","pink"];

var pie = d3.layout.pie()
    .sort(null);

var arc = d3.svg.arc()
    .innerRadius(radius - 60)
    .outerRadius(radius - 10);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

var path = svg.selectAll("path")
    .data(pie(type_counts))
  	.enter().append("path")
    .attr("fill", function(d, i) { return color[i]; })
    .attr("d", arc);

//smaller or bigger than Earth
var width = 250,
    height = 250,
    radius = Math.min(width, height) / 2;

var color = ["#993300","#ffd633","#339966","#d9d9d9", "#ccffff", "#80b3ff", "#0000cc"];

var pie = d3.layout.pie()
    .sort(null);

var arc = d3.svg.arc()
    .innerRadius(radius - 60)
    .outerRadius(radius - 10);

var svg2 = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

var path = svg2.selectAll("path")
    .data(pie(d_counts))
  	.enter().append("path")
    .attr("fill", function(d, i) { return color[i]; })
    .attr("d", arc);

//planet population comparison

var color = ["gray","#993300","#ffd633","#339966","#d9d9d9", "#ccffff", "#80b3ff", "#0000cc", "blue", "red","black","orange","yellow","green","purple","pink","yellow","green"];

var width = 550, 
	height = 550;

var scale = d3.scale.log().domain([1,d3.max(pops)]).range([10,180]);

pops.sort(function(a, b){return b-a});

var svg3 = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g");

svg3.selectAll('.circles').data(pops).enter().append('circle')
	.attr('r', function(d)  { return scale(d);})
	.attr("cy", height/2)
	.attr("cx", function(d,i) {return 270;})
	.attr("fill", function(d, i) { return color[i]; });

// svg3.selectAll("text").data(names).enter().append("text")
// 	.text(function(d) {return d;})
// 	.attr("font-size", 10)
// 	.attr("fill", function(d, i) { return color[i];})
// 	.attr("x", function(d,i){ return 50 + 150*i;})
// 	.attr("y", height/5)
// 	.attr("text-anchor", "middle");
});

</script>
</body>
</html>